rule hack_tool_user_agent {
 meta:
    author = "Florian Roth"
    description = "Detects suspicious user agent strings user by hack tools in proxy logs  License: https://github.com/Neo23x0/sigma/blob/master/LICENSE.Detection.Rules.md."
    reference = "https://tdm.socprime.com/tdm/info/zmMGplHFPuC2"
    version = "0.01"
    created = "2021-03-09"
    category = "proxy"

  events:
(re.regex($selection.principal.application, `.*\(hydra\).*`) or re.regex($selection.principal.application, `.* arachni/.*`) or re.regex($selection.principal.application, `.* BFAC .*`) or re.regex($selection.principal.application, `.* brutus .*`) or re.regex($selection.principal.application, `.* cgichk .*`) or re.regex($selection.principal.application, `.*core-project/1\.0.*`) or re.regex($selection.principal.application, `.* crimscanner/.*`) or re.regex($selection.principal.application, `.*datacha0s.*`) or re.regex($selection.principal.application, `.*dirbuster.*`) or re.regex($selection.principal.application, `.*domino hunter.*`) or re.regex($selection.principal.application, `.*dotdotpwn.*`) or $selection.principal.application = "FHScan Core" or re.regex($selection.principal.application, `.*floodgate.*`) or re.regex($selection.principal.application, `.*get-minimal.*`) or re.regex($selection.principal.application, `.*gootkit auto-rooter scanner.*`) or re.regex($selection.principal.application, `.*grendel-scan.*`) or re.regex($selection.principal.application, `.* inspath .*`) or re.regex($selection.principal.application, `.*internet ninja.*`) or re.regex($selection.principal.application, `.*jaascois.*`) or re.regex($selection.principal.application, `.* zmeu .*`) or re.regex($selection.principal.application, `.*masscan.*`) or re.regex($selection.principal.application, `.* metis .*`) or re.regex($selection.principal.application, `.*morfeus fucking scanner.*`) or re.regex($selection.principal.application, `.*n-stealth.*`) or re.regex($selection.principal.application, `.*nsauditor.*`) or re.regex($selection.principal.application, `.*pmafind.*`) or re.regex($selection.principal.application, `.*security scan.*`) or re.regex($selection.principal.application, `.*springenwerk.*`) or re.regex($selection.principal.application, `.*teh forest lobster.*`) or re.regex($selection.principal.application, `.*toata dragostea.*`) or re.regex($selection.principal.application, `.* vega/.*`) or re.regex($selection.principal.application, `.*voideye.*`) or re.regex($selection.principal.application, `.*webshag.*`) or re.regex($selection.principal.application, `.*webvulnscan.*`) or re.regex($selection.principal.application, `.* whcc/.*`) or re.regex($selection.principal.application, `.* Havij`) or re.regex($selection.principal.application, `.*absinthe.*`) or re.regex($selection.principal.application, `.*bsqlbf.*`) or re.regex($selection.principal.application, `.*mysqloit.*`) or re.regex($selection.principal.application, `.*pangolin.*`) or re.regex($selection.principal.application, `.*sql power injector.*`) or re.regex($selection.principal.application, `.*sqlmap.*`) or re.regex($selection.principal.application, `.*sqlninja.*`) or re.regex($selection.principal.application, `.*uil2pn.*`) or $selection.principal.application = "ruler" or $selection.principal.application = "Mozilla/5.0 (Windows; U; Windows NT 5.1; pt-PT; rv:1.9.1.2) Gecko/20090729 Firefox/3.5.2 (.NET CLR 3.5.30729)")

  condition:
    $selection
}
